# Интеграция Росдомофон для Home Assistant

Интеграция позволяет управлять устройствами Росдомофон (двери подъезда, шлагбаумы, ворота, калитки) из Home Assistant через облачный API Росдомофон.

## Возможности

- Управление замками Росдомофон как сущностями типа `lock` в Home Assistant.

## Требования

- Home Assistant **2023.9+**.
- Аккаунт в сервисе **Росдомофон** с привязанным номером телефона РФ.
- Установленный **HACS** (Home Assistant Community Store).

## Установка через HACS

1. Откройте **HACS → Integrations** в интерфейсе Home Assistant.
2. Нажмите кнопку **⋮ (три точки)** в правом верхнем углу и выберите **Custom repositories**.
3. В поле **Repository** укажите URL репозитория:
   - `https://github.com/iljyxa/rosdomofon-ha`
4. В поле **Category** выберите **Integration** и нажмите **Add**.
5. После добавления репозитория найдите интеграцию **Росдомофон** в списке HACS (поиск по названию "Росдомофон" или `rosdomofon`).
6. Откройте страницу интеграции и нажмите **Install**.
7. После установки перезагрузите Home Assistant (Restart).

## Настройка интеграции в Home Assistant

1. Перейдите в **Настройки → Устройства и службы → Добавить интеграцию**.
2. Найдите интеграцию **Росдомофон** (можно искать по имени или домену `rosdomofon`).
3. В первом шаге мастера настройки введите номер телефона РФ, зарегистрированный в Росдомофон. Вы можете вводить номер в привычном формате, например:
   - `+7 (999) 123-45-67`
   - `8 999 123 45 67`
   - `79991234567`
4. Нажмите **Далее**. Сервис Росдомофон отправит SMS с кодом подтверждения на указанный номер.
5. Во втором шаге введите код из SMS в поле **Код из SMS** и подтвердите.
6. При успешной авторизации будет создана запись интеграции с токеном доступа, а Home Assistant автоматически создаст сущности замков, привязанные к вашему аккаунту.

## Отладка и диагностика

- Интеграция использует стандартный логгер Home Assistant с именем `custom_components.rosdomofon`.
- Для подробной диагностики можно включить отладочный лог в `configuration.yaml`:

```yaml
default_config:

logger:
  default: warning
  logs:
    custom_components.rosdomofon: debug
```

После этого в логах Home Assistant будут отображаться запросы SMS, получение токенов, обновление токена и операции с замками.
